#!/bin/bash -ex

{% if 'git.openstack.org/openstack/tripleo-quickstart' in zuul.projects %}

tq={{ ansible_user_dir }}/{{ zuul.projects['git.openstack.org/openstack/tripleo-quickstart'].src_dir }}
export ANSIBLE_LIBRARY="${tq}/library"
export ANSIBLE_ROLES_PATH="${tq}/roles"

{% endif %}

export ANSIBLE_STDOUT_CALLBACK=debug

# To be able to use stuff installed with pip --user
# At zuul images we don't have any .bash_profile or .profile
export PATH=$PATH:$HOME/.local/bin

ansible-playbook -vv ~/start.yaml {% if ci_zuul_yaml if defined %}-e zuul_yaml={{ ci_zuul_yaml|to_json }}{% endif %}
